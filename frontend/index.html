<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°é—»çƒ­ç‚¹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
        
        body {
            background: #f5f5f5;
            min-height: 100vh;
        }
        
        /* å°çº¢ä¹¦é£æ ¼å¡ç‰‡ */
        .xhs-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .xhs-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
        }
        
        /* å›¾ç‰‡åŒºåŸŸ */
        .card-image {
            width: 100%;
            aspect-ratio: 3/4;
            object-fit: cover;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
        }
        
        .card-image.shanghai { background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%); }
        .card-image.world { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-image.ai { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .card-image.stocks { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .card-image.policy { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        
        .card-image::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60%;
            background: linear-gradient(to top, rgba(0,0,0,0.4), transparent);
        }
        
        .card-icon {
            position: absolute;
            top: 12px;
            left: 12px;
            width: 36px;
            height: 36px;
            background: rgba(255,255,255,0.95);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            z-index: 2;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .card-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 4px 10px;
            background: rgba(255,59,48,0.9);
            color: white;
            font-size: 11px;
            font-weight: 600;
            border-radius: 20px;
            z-index: 2;
        }
        
        /* ç€‘å¸ƒæµå¸ƒå±€ */
        .masonry-grid {
            column-count: 2;
            column-gap: 12px;
        }
        
        @media (min-width: 768px) {
            .masonry-grid {
                column-count: 3;
                column-gap: 16px;
            }
        }
        
        @media (min-width: 1024px) {
            .masonry-grid {
                column-count: 4;
                column-gap: 20px;
            }
        }
        
        .masonry-item {
            break-inside: avoid;
            margin-bottom: 12px;
        }
        
        @media (min-width: 768px) {
            .masonry-item {
                margin-bottom: 16px;
            }
        }
        
        /* æ ‡é¢˜æ ·å¼ */
        .card-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .card-meta {
            font-size: 12px;
            color: #999;
            margin-top: 8px;
        }
        
        .card-content {
            padding: 12px;
        }
        
        /* é¡¶éƒ¨å¯¼èˆª */
        .header {
            background: white;
            padding: 16px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .category-tabs {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding: 4px 0;
            scrollbar-width: none;
        }
        
        .category-tabs::-webkit-scrollbar {
            display: none;
        }
        
        .tab-btn {
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
        }
        
        .tab-btn.active {
            background: #FF2442;
            color: white;
        }
        
        .tab-btn:not(.active) {
            background: #f5f5f5;
            color: #666;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="flex items-center justify-between mb-4">
            <h1 class="text-xl font-bold text-gray-900">ğŸ“° æ–°é—»çƒ­ç‚¹</h1>
            <span id="update-time" class="text-xs text-gray-400"></span>
        </div>
        
        <div class="category-tabs">
            <button class="tab-btn active" onclick="switchTab('all', this)">å…¨éƒ¨</button>
            <button class="tab-btn" onclick="switchTab('shanghai', this)">ğŸ™ï¸ ä¸Šæµ·</button>
            <button class="tab-btn" onclick="switchTab('world', this)">ğŸŒ å›½é™…</button>
            <button class="tab-btn" onclick="switchTab('ai', this)">ğŸ¤– AI</button>
            <button class="tab-btn" onclick="switchTab('stocks', this)">ğŸ“ˆ ç¾è‚¡</button>
            <button class="tab-btn" onclick="switchTab('policy', this)">ğŸ‡¨ğŸ‡³ æ”¿ç­–</button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="p-3">
        <div id="news-grid" class="masonry-grid">
            <!-- æ–°é—»å¡ç‰‡å°†åœ¨è¿™é‡Œæ¸²æŸ“ -->
        </div>
        
        <div id="loading" class="text-center py-8 text-gray-400">
            <div class="inline-block w-6 h-6 border-2 border-gray-300 border-t-red-500 rounded-full animate-spin"></div>
            <p class="text-sm mt-2">åŠ è½½ä¸­...</p>
        </div>
    </main>

    <script>
        let allNews = {};
        let currentTab = 'all';
        
        const categoryConfig = {
            shanghai: { icon: 'ğŸ™ï¸', label: 'ä¸Šæµ·', color: 'shanghai' },
            world: { icon: 'ğŸŒ', label: 'å›½é™…', color: 'world' },
            ai: { icon: 'ğŸ¤–', label: 'AI', color: 'ai' },
            stocks: { icon: 'ğŸ“ˆ', label: 'ç¾è‚¡', color: 'stocks' },
            policy: { icon: 'ğŸ‡¨ğŸ‡³', label: 'æ”¿ç­–', color: 'policy' }
        };
        
        // åŠ è½½æ–°é—»
        async function loadNews() {
            try {
                const response = await fetch('data.json?t=' + Date.now());
                allNews = await response.json();
                renderNews();
                
                // æ›´æ–°æ—¶é—´
                document.getElementById('update-time').textContent = 
                    new Date().toLocaleString('zh-CN', { 
                        month: '2-digit', day: '2-digit', 
                        hour: '2-digit', minute: '2-digit' 
                    }) + ' æ›´æ–°';
                
                document.getElementById('loading').style.display = 'none';
            } catch (error) {
                console.error('åŠ è½½å¤±è´¥:', error);
                document.getElementById('loading').innerHTML = 
                    '<p class="text-red-400">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</p>';
            }
        }
        
        // æ¸²æŸ“æ–°é—»
        function renderNews() {
            const grid = document.getElementById('news-grid');
            grid.innerHTML = '';
            
            let items = [];
            
            if (currentTab === 'all') {
                // åˆå¹¶æ‰€æœ‰åˆ†ç±»
                Object.entries(allNews).forEach(([category, news]) => {
                    if (Array.isArray(news)) {
                        news.forEach(item => {
                            items.push({ ...item, category });
                        });
                    }
                });
                // éšæœºæ’åºè®©é¡µé¢æ›´æœ‰æ´»åŠ›
                items = items.sort(() => Math.random() - 0.5);
            } else {
                items = (allNews[currentTab] || []).map(item => ({ ...item, category: currentTab }));
            }
            
            // åªæ˜¾ç¤ºå‰50æ¡
            items = items.slice(0, 50);
            
            grid.innerHTML = items.map(item => createCard(item)).join('');
        }
        
        // åˆ›å»ºå¡ç‰‡
        function createCard(item) {
            const config = categoryConfig[item.category] || { icon: 'ğŸ“°', label: 'æ–°é—»', color: '' };
            const isNew = item.isNew ? '<span class="card-badge">NEW</span>' : '';
            
            // æå–æ ‡é¢˜ä¸­çš„ emoji
            const titleHasEmoji = /^[ğŸ ğŸ‘¥ğŸŒ¸ğŸš€âš¡ğŸ”‹ğŸ“ŠğŸ’ŠğŸª™â­â¬†ï¸ğŸ’¬]/u.test(item.title);
            const cleanTitle = item.title.replace(/^[ğŸ ğŸ‘¥ğŸŒ¸ğŸš€âš¡ğŸ”‹ğŸ“ŠğŸ’ŠğŸª™â­â¬†ï¸ğŸ’¬]\s*/u, '');
            
            return `
                <div class="masonry-item">
                    <a href="${item.link}" target="_blank" class="xhs-card block">
                        <div class="card-image ${config.color}">
                            <div class="card-icon">${config.icon}</div>
                            ${isNew}
                            <div class="absolute bottom-3 left-3 right-3 z-10">
                                <span class="text-white text-xs font-medium bg-black/30 px-2 py-1 rounded-full">
                                    ${config.label}
                                </span>
                            </div>
                        </div>
                        <div class="card-content">
                            <h3 class="card-title">${cleanTitle}</h3>
                            <div class="card-meta flex items-center justify-between">
                                <span>${item.source}</span>
                                <span>${item.time || ''}</span>
                            </div>
                        </div>
                    </a>
                </div>
            `;
        }
        
        // åˆ‡æ¢æ ‡ç­¾
        function switchTab(tab, btn) {
            currentTab = tab;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            // é‡æ–°æ¸²æŸ“
            renderNews();
        }
        
        // åˆå§‹åŒ–
        loadNews();
        
        // æ¯5åˆ†é’Ÿåˆ·æ–°
        setInterval(loadNews, 300000);
    </script>
</body>
</html>
