<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°é—»çƒ­ç‚¹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* æµ…è‰²æ¨¡å¼ - è«å…°è¿ªè‰²ç³» */
            --bg-primary: #f7f5f2;
            --bg-secondary: #ffffff;
            --bg-card: #ffffff;
            --text-primary: #2d2a26;
            --text-secondary: #6b6560;
            --text-tertiary: #9a9590;
            --border: #e8e4e0;
            --shadow: rgba(0,0,0,0.04);
            
            /* åˆ†ç±»é¢œè‰² - æŸ”å’Œè«å…°è¿ª */
            --color-shanghai: #c9b8a8;
            --color-world: #a8b5c9;
            --color-ai: #c9a8c2;
            --color-stocks: #a8c9b0;
            --color-policy: #c9c2a8;
            
            /* å¼ºè°ƒè‰² */
            --accent: #8b7355;
            --accent-hover: #6d5a42;
        }
        
        [data-theme="dark"] {
            /* æ·±è‰²æ¨¡å¼ - æš–ç°è°ƒ */
            --bg-primary: #1a1918;
            --bg-secondary: #242322;
            --bg-card: #2d2c2a;
            --text-primary: #f5f3f0;
            --text-secondary: #b8b4af;
            --text-tertiary: #8a8680;
            --border: #3d3c3a;
            --shadow: rgba(0,0,0,0.2);
            
            --color-shanghai: #8b7355;
            --color-world: #5a6b8a;
            --color-ai: #8a5a7a;
            --color-stocks: #5a8a6a;
            --color-policy: #8a825a;
            
            --accent: #c9b8a8;
            --accent-hover: #d4c4b5;
        }
        
        * { 
            font-family: 'Inter', 'Noto Sans SC', -apple-system, BlinkMacSystemFont, sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        body {
            background: var(--bg-primary);
            min-height: 100vh;
            color: var(--text-primary);
        }
        
        /* å¡ç‰‡æ ·å¼ */
        .xhs-card {
            background: var(--bg-card);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 2px 12px var(--shadow);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            border: 1px solid var(--border);
        }
        
        .xhs-card:hover {
            transform: translateY(-6px) scale(1.01);
            box-shadow: 0 12px 32px var(--shadow);
        }
        
        /* å›¾ç‰‡åŒºåŸŸ - æŠ½è±¡æ¸å˜ */
        .card-image {
            width: 100%;
            aspect-ratio: 4/5;
            position: relative;
            overflow: hidden;
        }
        
        .card-image::before {
            content: '';
            position: absolute;
            inset: 0;
            opacity: 0.9;
        }
        
        .card-image.shanghai::before { 
            background: linear-gradient(135deg, #e6ddd4 0%, #d4c9bd 50%, #c9b8a8 100%);
        }
        .card-image.world::before { 
            background: linear-gradient(135deg, #d4dde6 0%, #c9d4e0 50%, #a8b5c9 100%);
        }
        .card-image.ai::before { 
            background: linear-gradient(135deg, #e6d4e0 0%, #e0c9d8 50%, #c9a8c2 100%);
        }
        .card-image.stocks::before { 
            background: linear-gradient(135deg, #d4e6d8 0%, #c9e0d0 50%, #a8c9b0 100%);
        }
        .card-image.policy::before { 
            background: linear-gradient(135deg, #e6e0d4 0%, #e0d8c9 50%, #c9c2a8 100%);
        }
        
        /* æ·±è‰²æ¨¡å¼è°ƒæ•´ */
        [data-theme="dark"] .card-image.shanghai::before { 
            background: linear-gradient(135deg, #5a4d42 0%, #4a3d32 50%, #3d2d22 100%);
        }
        [data-theme="dark"] .card-image.world::before { 
            background: linear-gradient(135deg, #3a4a5a 0%, #2a3a4a 50%, #1a2a3a 100%);
        }
        [data-theme="dark"] .card-image.ai::before { 
            background: linear-gradient(135deg, #5a3a52 0%, #4a2a42 50%, #3a1a32 100%);
        }
        [data-theme="dark"] .card-image.stocks::before { 
            background: linear-gradient(135deg, #3a5a42 0%, #2a4a32 50%, #1a3a22 100%);
        }
        [data-theme="dark"] .card-image.policy::before { 
            background: linear-gradient(135deg, #5a523a 0%, #4a422a 50%, #3a321a 100%);
        }
        
        /* æŠ½è±¡å‡ ä½•å›¾æ¡ˆ */
        .geometric-pattern {
            position: absolute;
            inset: 0;
            opacity: 0.3;
        }
        
        .geometric-pattern::before,
        .geometric-pattern::after {
            content: '';
            position: absolute;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
        }
        
        .geometric-pattern::before {
            width: 60%;
            height: 60%;
            top: -20%;
            right: -20%;
        }
        
        .geometric-pattern::after {
            width: 40%;
            height: 40%;
            bottom: 10%;
            left: 10%;
        }
        
        /* å›¾æ ‡ */
        .card-icon {
            position: absolute;
            top: 16px;
            left: 16px;
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.95);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            z-index: 2;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }
        
        [data-theme="dark"] .card-icon {
            background: rgba(45,44,42,0.95);
        }
        
        /* æ ‡ç­¾ */
        .card-badge {
            position: absolute;
            top: 16px;
            right: 16px;
            padding: 6px 12px;
            background: rgba(139,115,85,0.9);
            color: white;
            font-size: 11px;
            font-weight: 600;
            border-radius: 20px;
            z-index: 2;
            letter-spacing: 0.5px;
        }
        
        .category-tag {
            position: absolute;
            bottom: 16px;
            left: 16px;
            padding: 6px 14px;
            background: rgba(255,255,255,0.95);
            color: var(--text-primary);
            font-size: 12px;
            font-weight: 500;
            border-radius: 20px;
            z-index: 2;
            backdrop-filter: blur(10px);
        }
        
        [data-theme="dark"] .category-tag {
            background: rgba(45,44,42,0.95);
            color: var(--text-primary);
        }
        
        /* ç€‘å¸ƒæµ */
        .masonry-grid {
            column-count: 2;
            column-gap: 16px;
            padding: 16px;
        }
        
        @media (min-width: 768px) {
            .masonry-grid {
                column-count: 3;
                column-gap: 20px;
                padding: 20px;
            }
        }
        
        @media (min-width: 1024px) {
            .masonry-grid {
                column-count: 4;
                column-gap: 24px;
                padding: 24px;
            }
        }
        
        .masonry-item {
            break-inside: avoid;
            margin-bottom: 16px;
        }
        
        @media (min-width: 768px) {
            .masonry-item {
                margin-bottom: 20px;
            }
        }
        
        /* æ ‡é¢˜æ ·å¼ */
        .card-title {
            font-size: 15px;
            font-weight: 500;
            color: var(--text-primary);
            line-height: 1.6;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .card-summary {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.5;
            margin-top: 8px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .card-meta {
            font-size: 12px;
            color: var(--text-tertiary);
            margin-top: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .card-content {
            padding: 16px;
        }
        
        /* é¡¶éƒ¨å¯¼èˆª */
        .header {
            background: var(--bg-secondary);
            padding: 16px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--border);
        }
        
        .category-tabs {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 4px 0;
            scrollbar-width: none;
        }
        
        .category-tabs::-webkit-scrollbar {
            display: none;
        }
        
        .tab-btn {
            padding: 10px 24px;
            border-radius: 24px;
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            background: transparent;
            color: var(--text-secondary);
        }
        
        .tab-btn:hover {
            background: var(--bg-primary);
            color: var(--text-primary);
        }
        
        .tab-btn.active {
            background: var(--accent);
            color: white;
        }
        
        /* ä¸»é¢˜åˆ‡æ¢æŒ‰é’® */
        .theme-toggle {
            width: 44px;
            height: 44px;
            border-radius: 14px;
            border: 1px solid var(--border);
            background: var(--bg-card);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s;
        }
        
        .theme-toggle:hover {
            transform: scale(1.05);
            background: var(--bg-primary);
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .skeleton {
            background: linear-gradient(90deg, var(--bg-primary) 25%, var(--border) 50%, var(--bg-primary) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        /* æ»šåŠ¨æ¡ç¾åŒ– */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-tertiary);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="flex items-center justify-between mb-4">
            <h1 class="text-xl font-semibold" style="color: var(--text-primary);">æ–°é—»çƒ­ç‚¹</h1>
            <div class="flex items-center gap-3">
                <span id="update-time" class="text-xs" style="color: var(--text-tertiary);"></span>
                <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ™</button>
            </div>
        </div>
        
        <div class="category-tabs">
            <button class="tab-btn active" onclick="switchTab('all', this)">å…¨éƒ¨</button>
            <button class="tab-btn" onclick="switchTab('shanghai', this)">ğŸ™ï¸ ä¸Šæµ·</button>
            <button class="tab-btn" onclick="switchTab('world', this)">ğŸŒ å›½é™…</button>
            <button class="tab-btn" onclick="switchTab('ai', this)">ğŸ¤– AI</button>
            <button class="tab-btn" onclick="switchTab('stocks', this)">ğŸ“ˆ ç¾è‚¡</button>
            <button class="tab-btn" onclick="switchTab('policy', this)">ğŸ‡¨ğŸ‡³ æ”¿ç­–</button>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <div id="news-grid" class="masonry-grid">
            <!-- æ–°é—»å¡ç‰‡å°†åœ¨è¿™é‡Œæ¸²æŸ“ -->
        </div>
        
        <div id="loading" class="text-center py-12" style="color: var(--text-tertiary);">
            <div class="inline-block w-8 h-8 border-2 rounded-full animate-spin" 
                 style="border-color: var(--border); border-top-color: var(--accent);"></div>
            <p class="text-sm mt-3">åŠ è½½ä¸­...</p>
        </div>
    </main>

    <script>
        let allNews = {};
        let currentTab = 'all';
        
        const categoryConfig = {
            shanghai: { icon: 'ğŸ™ï¸', label: 'ä¸Šæµ·', color: 'shanghai' },
            world: { icon: 'ğŸŒ', label: 'å›½é™…', color: 'world' },
            ai: { icon: 'ğŸ¤–', label: 'AI', color: 'ai' },
            stocks: { icon: 'ğŸ“ˆ', label: 'ç¾è‚¡', color: 'stocks' },
            policy: { icon: 'ğŸ‡¨ğŸ‡³', label: 'æ”¿ç­–', color: 'policy' }
        };
        
        // ä¸»é¢˜åˆ‡æ¢
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            // æ›´æ–°æŒ‰é’®å›¾æ ‡
            document.querySelector('.theme-toggle').textContent = newTheme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
        }
        
        // åˆå§‹åŒ–ä¸»é¢˜
        function initTheme() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = savedTheme || (prefersDark ? 'dark' : 'light');
            
            document.documentElement.setAttribute('data-theme', theme);
            document.querySelector('.theme-toggle').textContent = theme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
        }
        
        // åŠ è½½æ–°é—»
        async function loadNews() {
            try {
                const response = await fetch('data.json?t=' + Date.now());
                allNews = await response.json();
                renderNews();
                
                // æ›´æ–°æ—¶é—´
                document.getElementById('update-time').textContent = 
                    new Date().toLocaleString('zh-CN', { 
                        month: '2-digit', day: '2-digit', 
                        hour: '2-digit', minute: '2-digit' 
                    }) + ' æ›´æ–°';
                
                document.getElementById('loading').style.display = 'none';
            } catch (error) {
                console.error('åŠ è½½å¤±è´¥:', error);
                document.getElementById('loading').innerHTML = 
                    '<p style="color: var(--accent);">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</p>';
            }
        }
        
        // æ¸²æŸ“æ–°é—»
        function renderNews() {
            const grid = document.getElementById('news-grid');
            grid.innerHTML = '';
            
            let items = [];
            
            if (currentTab === 'all') {
                Object.entries(allNews).forEach(([category, news]) => {
                    if (Array.isArray(news)) {
                        news.forEach(item => {
                            items.push({ ...item, category });
                        });
                    }
                });
                items = items.sort(() => Math.random() - 0.5);
            } else {
                items = (allNews[currentTab] || []).map(item => ({ ...item, category: currentTab }));
            }
            
            items = items.slice(0, 50);
            
            grid.innerHTML = items.map(item => createCard(item)).join('');
        }
        
        // åˆ›å»ºå¡ç‰‡
        function createCard(item) {
            const config = categoryConfig[item.category] || { icon: 'ğŸ“°', label: 'æ–°é—»', color: '' };
            const isNew = item.isNew ? '<span class="card-badge">NEW</span>' : '';
            
            // æ¸…ç†æ ‡é¢˜ä¸­çš„ emoji
            const cleanTitle = item.title.replace(/^[ğŸ ğŸ‘¥ğŸŒ¸ğŸš€âš¡ğŸ”‹ğŸ“ŠğŸ’ŠğŸª™â­â¬†ï¸ğŸ’¬ğŸ‡¨ğŸ‡³]\s*/u, '');
            
            // æ‘˜è¦ï¼ˆå¦‚æœæœ‰ï¼‰
            const summary = item.summary && item.summary !== config.label 
                ? `<p class="card-summary">${item.summary}</p>` 
                : '';
            
            return `
                <div class="masonry-item">
                    <a href="${item.link}" target="_blank" class="xhs-card block">
                        <div class="card-image ${config.color}">
                            <div class="geometric-pattern"></div>
                            <div class="card-icon">${config.icon}</div>
                            ${isNew}
                            <span class="category-tag">${config.label}</span>
                        </div>
                        <div class="card-content">
                            <h3 class="card-title">${cleanTitle}</h3>
                            ${summary}
                            <div class="card-meta">
                                <span>${item.source}</span>
                                <span>Â·</span>
                                <span>${item.time || ''}</span>
                            </div>
                        </div>
                    </a>
                </div>
            `;
        }
        
        // åˆ‡æ¢æ ‡ç­¾
        function switchTab(tab, btn) {
            currentTab = tab;
            
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            renderNews();
        }
        
        // åˆå§‹åŒ–
        initTheme();
        loadNews();
        
        // æ¯5åˆ†é’Ÿåˆ·æ–°
        setInterval(loadNews, 300000);
    </script>
</body>
</html>
